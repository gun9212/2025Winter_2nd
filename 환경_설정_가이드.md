# 환경 설정 가이드

이 문서는 IdealMatch 프로젝트 개발 환경을 구성하기 위한 완전한 가이드입니다.

---

## 목차

1. [시스템 요구사항](#시스템-요구사항)
2. [필수 소프트웨어 설치](#필수-소프트웨어-설치)
3. [프론트엔드 설정](#프론트엔드-설정)
4. [백엔드 설정](#백엔드-설정)
5. [개발 서버 실행](#개발-서버-실행)
6. [에뮬레이터/시뮬레이터 설정](#에뮬레이터시뮬레이터-설정)
7. [트러블슈팅](#트러블슈팅)

---

## 시스템 요구사항

### 최소 요구사항

- **운영체제**: macOS 13+, Windows 10+, Linux (Ubuntu 20.04+)
- **메모리**: 8GB RAM (권장: 16GB)
- **디스크 공간**: 10GB 이상 여유 공간
- **인터넷 연결**: 패키지 다운로드 필요

### 권장 사양

- **macOS**: macOS 14+ (iOS 개발 필수)
- **메모리**: 16GB RAM
- **디스크 공간**: 20GB 이상

---

## 필수 소프트웨어 설치

### 1. Node.js 및 npm

**필수 버전**: Node.js >= 16

#### macOS
```bash
# Homebrew 사용 (권장)
brew install node@18

# 또는 공식 사이트에서 다운로드
# https://nodejs.org/
```

#### Linux (Ubuntu/Debian)
```bash
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs
```

#### Windows
1. https://nodejs.org/ 에서 LTS 버전 다운로드
2. 설치 마법사 실행

**설치 확인:**
```bash
node --version  # v18.x.x 이상
npm --version   # 9.x.x 이상
```

---

### 2. Python

**필수 버전**: Python >= 3.10

#### macOS
```bash
# Homebrew 사용 (권장)
brew install python@3.11

# 또는 pyenv 사용
brew install pyenv
pyenv install 3.11.7
pyenv global 3.11.7
```

#### Linux (Ubuntu/Debian)
```bash
sudo apt update
sudo apt install python3.11 python3.11-venv python3-pip
```

#### Windows
1. https://www.python.org/downloads/ 에서 Python 3.11 다운로드
2. 설치 시 "Add Python to PATH" 옵션 선택

**설치 확인:**
```bash
python3 --version  # Python 3.10.x 이상
pip3 --version
```

---

### 3. PostgreSQL

#### macOS
```bash
# Homebrew 사용
brew install postgresql@15
brew services start postgresql@15

# 또는 PostgreSQL.app 다운로드
# https://postgresapp.com/
```

#### Linux (Ubuntu/Debian)
```bash
sudo apt update
sudo apt install postgresql postgresql-contrib
sudo systemctl start postgresql
sudo systemctl enable postgresql
```

#### Windows
1. https://www.postgresql.org/download/windows/ 에서 다운로드
2. 설치 마법사 실행 (기본 포트 5432)

**설치 확인:**
```bash
psql --version
```

---

### 4. Redis (선택사항, 향후 사용 예정)

#### macOS
```bash
brew install redis
brew services start redis
```

#### Linux (Ubuntu/Debian)
```bash
sudo apt install redis-server
sudo systemctl start redis
sudo systemctl enable redis
```

#### Windows
- WSL2 사용 또는 Docker 사용 권장
- 또는 https://github.com/microsoftarchive/redis/releases 에서 다운로드

---

### 5. iOS 개발 환경 (macOS만 해당)

#### Xcode 설치
1. App Store에서 Xcode 설치 (약 15GB)
2. Command Line Tools 설치:
```bash
xcode-select --install
```

#### CocoaPods 설치
```bash
sudo gem install cocoapods
pod --version  # 확인
```

**설치 확인:**
```bash
xcodebuild -version
pod --version
```

---

### 6. Android 개발 환경

#### Android Studio 설치
1. https://developer.android.com/studio 에서 다운로드
2. 설치 후 Android Studio 실행
3. SDK Manager에서 다음 설치:
   - Android SDK Platform 33
   - Android SDK Build-Tools
   - Android Virtual Device (AVD)

#### 환경 변수 설정

**macOS/Linux:**
```bash
# ~/.zshrc 또는 ~/.bashrc에 추가
export ANDROID_HOME=$HOME/Library/Android/sdk
export PATH=$PATH:$ANDROID_HOME/emulator
export PATH=$PATH:$ANDROID_HOME/platform-tools
export PATH=$PATH:$ANDROID_HOME/tools
export PATH=$PATH:$ANDROID_HOME/tools/bin
```

**Windows:**
1. 시스템 환경 변수 설정
2. `ANDROID_HOME` = `C:\Users\YourName\AppData\Local\Android\Sdk`
3. PATH에 추가:
   - `%ANDROID_HOME%\platform-tools`
   - `%ANDROID_HOME%\emulator`
   - `%ANDROID_HOME%\tools`
   - `%ANDROID_HOME%\tools\bin`

**설치 확인:**
```bash
adb --version
```

---

## 프론트엔드 설정

### 1. 프로젝트 클론 및 이동

```bash
# 프로젝트 디렉토리로 이동
cd /path/to/project/Frontend/IdealMatchApp
```

### 2. Node.js 패키지 설치

```bash
# npm 패키지 설치
npm install

# 설치 시간이 오래 걸릴 수 있습니다 (5-10분)
```

**문제 발생 시:**
```bash
# 캐시 정리 후 재설치
npm cache clean --force
rm -rf node_modules package-lock.json
npm install
```

### 3. iOS 설정 (macOS만)

```bash
# CocoaPods 의존성 설치
cd ios
pod install
cd ..

# 시간이 오래 걸릴 수 있습니다 (10-15분)
```

**문제 발생 시:**
```bash
# Pod 캐시 정리
cd ios
rm -rf Pods Podfile.lock
pod cache clean --all
pod install
cd ..
```

### 4. Android 설정

Android Studio에서 Gradle이 자동으로 동기화됩니다.

**수동 실행이 필요한 경우:**
```bash
cd android
./gradlew clean
./gradlew build
cd ..
```

---

## 백엔드 설정

### 1. 프로젝트 디렉토리 이동

```bash
cd /path/to/project/backend
```

### 2. Python 가상환경 생성

```bash
# 가상환경 생성
python3 -m venv venv

# 가상환경 활성화
# macOS/Linux:
source venv/bin/activate

# Windows:
venv\Scripts\activate
```

**가상환경 활성화 확인:**
- 터미널 프롬프트에 `(venv)` 표시가 나타나야 합니다.

### 3. Python 패키지 설치

```bash
# pip 업그레이드
pip install --upgrade pip

# requirements.txt에서 패키지 설치
pip install -r requirements.txt

# 설치 시간이 오래 걸릴 수 있습니다 (5-10분)
```

### 4. PostgreSQL 데이터베이스 생성

```bash
# PostgreSQL 접속
psql -U postgres

# 또는 사용자 지정
psql -U your_username -d postgres
```

**SQL 실행:**
```sql
-- 데이터베이스 생성
CREATE DATABASE ideal_match_db;

-- 권한 확인 (필요한 경우)
GRANT ALL PRIVILEGES ON DATABASE ideal_match_db TO postgres;

-- 종료
\q
```

### 5. 환경 변수 설정

`backend` 디렉토리에 `.env` 파일 생성:

```bash
cd backend
touch .env  # macOS/Linux
# 또는 메모장으로 .env 파일 생성 (Windows)
```

**.env 파일 내용:**
```bash
# 데이터베이스 설정
DB_NAME=ideal_match_db
DB_USER=postgres
DB_PASSWORD=postgres
DB_HOST=localhost
DB_PORT=5432

# Django 설정
SECRET_KEY=django-insecure-change-this-in-production-please-use-random-string
DEBUG=True
ALLOWED_HOSTS=localhost,127.0.0.1

# Redis 설정 (선택사항)
REDIS_HOST=localhost
REDIS_PORT=6379
```

**⚠️ 주의사항:**
- `SECRET_KEY`는 프로덕션 환경에서 반드시 변경해야 합니다.
- `.env` 파일은 Git에 커밋하지 마세요 (이미 .gitignore에 포함됨).

### 6. Django 마이그레이션 실행

```bash
# 가상환경이 활성화되어 있는지 확인
# 마이그레이션 생성 (이미 존재하는 경우 생략 가능)
python manage.py makemigrations

# 데이터베이스에 마이그레이션 적용
python manage.py migrate

# 관리자 계정 생성 (선택사항)
python manage.py createsuperuser
```

**데이터베이스 연결 확인:**
```bash
python test_db_connection.py
```

---

## 개발 서버 실행

### 프론트엔드 (React Native)

#### 1. Metro Bundler 시작

```bash
cd Frontend/IdealMatchApp

# 새 터미널 창에서 실행
npm start

# 또는 캐시 리셋이 필요한 경우
npm start -- --reset-cache
```

#### 2. iOS 시뮬레이터 실행 (macOS만)

```bash
# 새 터미널 창에서 실행
npm run ios

# 특정 시뮬레이터 지정
npm run ios -- --simulator="iPhone 15 Pro"
```

#### 3. Android 에뮬레이터 실행

**먼저 에뮬레이터 실행:**
```bash
# 에뮬레이터 목록 확인
emulator -list-avds

# 에뮬레이터 실행
emulator -avd <AVD_NAME>
```

**또는 Android Studio에서 AVD Manager로 실행**

**앱 실행:**
```bash
# 새 터미널 창에서 실행
npm run android
```

---

### 백엔드 (Django)

```bash
cd backend

# 가상환경 활성화 (아직 안 했다면)
source venv/bin/activate  # macOS/Linux
# 또는
venv\Scripts\activate  # Windows

# Django 개발 서버 실행
python manage.py runserver

# 서버가 http://127.0.0.1:8000/ 에서 실행됩니다
```

**다른 포트 지정:**
```bash
python manage.py runserver 8001
```

---

## 에뮬레이터/시뮬레이터 설정

### iOS 시뮬레이터 (macOS만)

#### Xcode에서 시뮬레이터 실행
1. Xcode 실행
2. 상단 메뉴: `Xcode > Open Developer Tool > Simulator`
3. 또는 Spotlight에서 "Simulator" 검색

#### 사용 가능한 시뮬레이터 확인
```bash
xcrun simctl list devices
```

#### 시뮬레이터 설치 (Xcode에서)
1. Xcode 실행
2. `Xcode > Settings > Platforms`
3. 원하는 iOS 버전 다운로드

**권장 시뮬레이터:**
- iPhone 15 Pro (iOS 17+)
- iPhone 14 (iOS 16+)

---

### Android 에뮬레이터

#### AVD (Android Virtual Device) 생성

**Android Studio에서:**
1. Android Studio 실행
2. `Tools > Device Manager`
3. `Create Device` 클릭
4. 원하는 기기 선택 (예: Pixel 7)
5. 시스템 이미지 선택 (API 33 이상 권장)
6. AVD 이름 설정 및 생성

**명령줄에서:**
```bash
# AVD Manager 실행
avdmanager list target
avdmanager create avd -n Pixel7 -k "system-images;android-33;google_apis;x86_64"
```

#### 에뮬레이터 성능 최적화

**macOS (Apple Silicon):**
- 자동으로 ARM64 이미지 사용
- 성능이 빠름

**Intel Mac / Windows:**
- x86_64 이미지 사용
- HAXM 또는 Hyper-V 활성화 필요

**HAXM 설치 (Intel Mac):**
```bash
# Android Studio SDK Manager에서 설치
# Tools > SDK Manager > SDK Tools > Intel x86 Emulator Accelerator (HAXM)
```

**Hyper-V 활성화 (Windows):**
1. Windows 기능 켜기/끄기
2. Hyper-V 선택
3. 재부팅

---

## 트러블슈팅

### 프론트엔드 문제

#### 1. Metro Bundler 시작 오류

**문제**: `Error: EADDRINUSE: address already in use`

**해결:**
```bash
# 포트 8081 사용 중인 프로세스 종료
lsof -ti:8081 | xargs kill -9  # macOS/Linux

# Windows
netstat -ano | findstr :8081
taskkill /PID <PID> /F
```

#### 2. iOS 빌드 오류

**문제**: `pod install` 실패

**해결:**
```bash
cd ios
rm -rf Pods Podfile.lock
pod cache clean --all
pod install --repo-update
cd ..
```

**문제**: Xcode 빌드 오류

**해결:**
```bash
# DerivedData 삭제
rm -rf ~/Library/Developer/Xcode/DerivedData

# 프로젝트 클린
cd ios
xcodebuild clean
pod install
cd ..
```

#### 3. Android 빌드 오류

**문제**: Gradle 동기화 실패

**해결:**
```bash
cd android
./gradlew clean
./gradlew --stop
cd ..
npm run android
```

**문제**: `SDK location not found`

**해결:**
```bash
# android/local.properties 파일 생성
echo "sdk.dir=$ANDROID_HOME" > android/local.properties
```

#### 4. 네트워크 연결 오류 (iOS 시뮬레이터)

**문제**: `http://localhost:8000`에 연결 안 됨

**해결:**
- `localhost` 대신 `127.0.0.1` 사용
- 또는 Mac의 실제 IP 주소 사용
- `config.js`에서 `API_BASE_URL` 확인

---

### 백엔드 문제

#### 1. 데이터베이스 연결 오류

**문제**: `FATAL: password authentication failed`

**해결:**
1. PostgreSQL 비밀번호 확인
2. `.env` 파일의 `DB_PASSWORD` 확인
3. `pg_hba.conf` 설정 확인

**macOS:**
```bash
# PostgreSQL 접속 시도
psql -U postgres -d ideal_match_db
```

**비밀번호 재설정:**
```bash
psql -U postgres
ALTER USER postgres WITH PASSWORD 'postgres';
```

#### 2. 마이그레이션 오류

**문제**: `No migrations to apply`

**해결:**
```bash
# 마이그레이션 파일 확인
python manage.py showmigrations

# 특정 앱의 마이그레이션 강제 적용
python manage.py migrate users --fake-initial
```

#### 3. 패키지 설치 오류

**문제**: `psycopg2-binary` 설치 실패

**해결:**
```bash
# macOS
brew install postgresql
export LDFLAGS="-L/usr/local/opt/postgresql/lib"
export CPPFLAGS="-I/usr/local/opt/postgresql/include"
pip install psycopg2-binary

# Linux
sudo apt install libpq-dev python3-dev
pip install psycopg2-binary
```

#### 4. 포트 사용 중 오류

**문제**: `Error: That port is already in use`

**해결:**
```bash
# 포트 8000 사용 중인 프로세스 확인 및 종료
lsof -ti:8000 | xargs kill -9  # macOS/Linux

# Windows
netstat -ano | findstr :8000
taskkill /PID <PID> /F

# 또는 다른 포트 사용
python manage.py runserver 8001
```

---

### 공통 문제

#### 1. Git 충돌

**문제**: 패키지 파일 충돌

**해결:**
```bash
# 프론트엔드
cd Frontend/IdealMatchApp
rm -rf node_modules package-lock.json
npm install

# 백엔드
cd backend
rm -rf venv
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

#### 2. 권한 오류

**문제**: 파일 쓰기 권한 없음

**해결:**
```bash
# macOS/Linux
sudo chown -R $(whoami) /path/to/project

# 또는 특정 디렉토리만
chmod -R 755 node_modules
```

---

## 개발 워크플로우

### 일반적인 개발 시작 순서

1. **백엔드 서버 시작:**
```bash
cd backend
source venv/bin/activate
python manage.py runserver
```

2. **Metro Bundler 시작:**
```bash
cd Frontend/IdealMatchApp
npm start
```

3. **앱 실행:**
   - iOS: 새 터미널에서 `npm run ios`
   - Android: 에뮬레이터 실행 후 `npm run android`

### 코드 변경 시

- **프론트엔드**: Metro Bundler가 자동으로 리로드 (Fast Refresh)
- **백엔드**: Django가 자동으로 리로드 (코드 변경 감지)
- **네이티브 코드 변경 시**: 앱 재빌드 필요 (`npm run ios/android`)

---

## 추가 유용한 명령어

### 프론트엔드

```bash
# 캐시 완전 정리
npm start -- --reset-cache

# iOS 빌드 클린
cd ios
xcodebuild clean
pod install
cd ..

# Android 빌드 클린
cd android
./gradlew clean
cd ..
```

### 백엔드

```bash
# 마이그레이션 상태 확인
python manage.py showmigrations

# 관리자 사이트 접속
# http://127.0.0.1:8000/admin/

# Django Shell
python manage.py shell

# 데이터베이스 백업 (선택사항)
python manage.py dumpdata > backup.json
```

---

## 참고 자료

- **React Native 공식 문서**: https://reactnative.dev/docs/getting-started
- **Django 공식 문서**: https://docs.djangoproject.com/
- **PostgreSQL 문서**: https://www.postgresql.org/docs/
- **프로젝트 내 문서**:
  - `backend/DB_ACCESS_GUIDE.md` - 데이터베이스 접근 가이드
  - `backend/API_DOCUMENTATION.md` - API 문서
  - `Frontend/docs/TROUBLESHOOTING_GUIDE.md` - 트러블슈팅 가이드

---

## 지원

문제가 발생하면:
1. 이 문서의 트러블슈팅 섹션 확인
2. 프로젝트 내 문서 확인
3. 팀 슬랙/채널에 문의

---

**마지막 업데이트**: 2025-01-15
