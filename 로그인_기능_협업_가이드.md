# ë¡œê·¸ì¸ ê¸°ëŠ¥ êµ¬í˜„ - í˜‘ì—… ê°€ì´ë“œ

## ğŸ‘¥ ì—­í•  ë¶„ë‹´

### ğŸ”´ ë‹´ë‹¹ì A: ë°±ì—”ë“œ (Django)
- Serializers êµ¬í˜„
- Views (API ì—”ë“œí¬ì¸íŠ¸) êµ¬í˜„
- URL ë¼ìš°íŒ… ì„¤ì •

### ğŸ”µ ë‹´ë‹¹ì B: í”„ë¡ íŠ¸ì—”ë“œ (React Native)
- API í´ë¼ì´ì–¸íŠ¸ ì¸ì¦ í•¨ìˆ˜ ì¶”ê°€
- AuthContext ì‹¤ì œ API ì—°ë™
- í™”ë©´ ì—°ë™ ë° ì—ëŸ¬ ì²˜ë¦¬

---

## ğŸ“‹ ì „ì²´ ì‘ì—… ìˆœì„œ

### Phase 1: ë³‘ë ¬ ì‘ì—… (ë…ë¦½ì )
ë‘ ë‹´ë‹¹ìê°€ ë™ì‹œì— ì‘ì—… ê°€ëŠ¥

#### ğŸ”´ ë°±ì—”ë“œ ë‹´ë‹¹ì (ë‹´ë‹¹ì A)

**1-1. Serializers êµ¬í˜„** â±ï¸ ì˜ˆìƒ: 30ë¶„
- íŒŒì¼: `backend/apps/users/serializers.py`
- ì‘ì—… ë‚´ìš©:
  - `RegisterSerializer` ìƒì„±
    - í•„ë“œ: `username`, `password`, `phone_number`
    - ë¹„ë°€ë²ˆí˜¸ ê²€ì¦ (ìµœì†Œ ê¸¸ì´ ë“±)
    - ì¤‘ë³µ ì²´í¬ (username, phone_number)
  - `AuthUserSerializer` ìƒì„± (ì‚¬ìš©ì ì •ë³´ ë°˜í™˜ìš©)
    - id, username, phone_number ë°˜í™˜
    - ë¹„ë°€ë²ˆí˜¸ëŠ” ì œì™¸

**ì²´í¬ë¦¬ìŠ¤íŠ¸:**
```python
# serializers.py ì˜ˆì‹œ êµ¬ì¡°
from rest_framework import serializers
from .models import AuthUser

class RegisterSerializer(serializers.ModelSerializer):
    password = serializers.CharField(write_only=True, ...)
    
class AuthUserSerializer(serializers.ModelSerializer):
    # ì½ê¸° ì „ìš© í•„ë“œë“¤
```

---

#### ğŸ”µ í”„ë¡ íŠ¸ì—”ë“œ ë‹´ë‹¹ì (ë‹´ë‹¹ì B)

**1-2. API í´ë¼ì´ì–¸íŠ¸ í™•ì¥** â±ï¸ ì˜ˆìƒ: 30ë¶„
- íŒŒì¼: `Frontend/IdealMatchApp/src/services/api/apiClient.js`
- ì‘ì—… ë‚´ìš©:
  - `register(username, password, phoneNumber)` í•¨ìˆ˜ ì¶”ê°€
  - `login(username, password)` í•¨ìˆ˜ ì¶”ê°€
  - `refreshToken(refreshToken)` í•¨ìˆ˜ ì¶”ê°€
  - `getCurrentUser()` í•¨ìˆ˜ ì¶”ê°€ (ì„ íƒì‚¬í•­)

**ì²´í¬ë¦¬ìŠ¤íŠ¸:**
```javascript
// apiClient.jsì— ì¶”ê°€í•  í•¨ìˆ˜ë“¤
async register(username, password, phoneNumber) {
  // POST /api/auth/register/
  // í† í° ì €ì¥í•˜ì§€ ì•ŠìŒ (íšŒì›ê°€ì…ë§Œ)
}

async login(username, password) {
  // POST /api/auth/login/
  // í† í° ìë™ ì €ì¥
  // return { access, refresh, user }
}

async refreshToken(refreshToken) {
  // POST /api/auth/refresh/
  // ìƒˆ access token ë°œê¸‰
}
```

---

### Phase 2: ë°±ì—”ë“œ ì™„ì„± (ë‹´ë‹¹ì A)

**2-1. Views êµ¬í˜„** â±ï¸ ì˜ˆìƒ: 45ë¶„
- íŒŒì¼: `backend/apps/users/views.py`
- ì‘ì—… ë‚´ìš©:
  - `RegisterView` - íšŒì›ê°€ì… API
    - `POST /api/auth/register/`
    - RegisterSerializer ì‚¬ìš©
    - AuthUser ìƒì„± í›„ ì§ë ¬í™”í•˜ì—¬ ë°˜í™˜
  - `LoginView` - ë¡œê·¸ì¸ API
    - `POST /api/auth/login/`
    - Simple JWTì˜ `TokenObtainPairView` ì‚¬ìš© ë˜ëŠ” ì»¤ìŠ¤í…€
    - Access Token + Refresh Token ë°œê¸‰
    - ì‚¬ìš©ì ì •ë³´ í¬í•¨ ë°˜í™˜
  - `TokenRefreshView` - í† í° ê°±ì‹  (Simple JWT ê¸°ë³¸ ì‚¬ìš©)
  - `UserProfileView` - ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ (ì„ íƒì‚¬í•­)
    - `GET /api/auth/me/`

**API ì‘ë‹µ í˜•ì‹ ì˜ˆì‹œ:**
```json
// POST /api/auth/login/ ì‘ë‹µ
{
  "access": "eyJ0eXAiOiJKV1QiLCJh...",
  "refresh": "eyJ0eXAiOiJKV1QiLCJh...",
  "user": {
    "id": 1,
    "username": "testuser",
    "phone_number": "01012345678"
  }
}

// POST /api/auth/register/ ì‘ë‹µ
{
  "id": 1,
  "username": "testuser",
  "phone_number": "01012345678",
  "date_joined": "2025-01-15T10:00:00Z"
}
```

**ì²´í¬ë¦¬ìŠ¤íŠ¸:**
- [ ] íšŒì›ê°€ì… API í…ŒìŠ¤íŠ¸ (Postman/curl)
- [ ] ë¡œê·¸ì¸ API í…ŒìŠ¤íŠ¸ (í† í° ë°œê¸‰ í™•ì¸)
- [ ] ì—ëŸ¬ ì²˜ë¦¬ í™•ì¸ (ì¤‘ë³µ username, ì˜ëª»ëœ ë¹„ë°€ë²ˆí˜¸ ë“±)

---

**2-2. URL ë¼ìš°íŒ…** â±ï¸ ì˜ˆìƒ: 15ë¶„
- íŒŒì¼: `backend/apps/users/urls.py`
- ì‘ì—… ë‚´ìš©:
  ```python
  urlpatterns = [
      path('auth/register/', views.RegisterView.as_view(), name='register'),
      path('auth/login/', views.LoginView.as_view(), name='login'),
      path('auth/refresh/', TokenRefreshView.as_view(), name='token_refresh'),
      path('auth/me/', views.UserProfileView.as_view(), name='user_profile'),
  ]
  ```

- íŒŒì¼: `backend/config/urls.py` (í™•ì¸)
  - `path('api/users/', include('apps.users.urls'))` ì´ë¯¸ ìˆëŠ”ì§€ í™•ì¸

**ì²´í¬ë¦¬ìŠ¤íŠ¸:**
- [ ] ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ ì ‘ê·¼ ê°€ëŠ¥í•œì§€ í™•ì¸
- [ ] `/api/users/auth/register/` ì ‘ê·¼ í…ŒìŠ¤íŠ¸
- [ ] `/api/users/auth/login/` ì ‘ê·¼ í…ŒìŠ¤íŠ¸

---

### Phase 3: í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™ (ë‹´ë‹¹ì B)

**âš ï¸ Phase 2 ì™„ë£Œ í›„ ì‹œì‘ ê°€ëŠ¥**

**3-1. AuthContext ì‹¤ì œ API ì—°ë™** â±ï¸ ì˜ˆìƒ: 1ì‹œê°„
- íŒŒì¼: `Frontend/IdealMatchApp/src/context/AuthContext.js`
- ì‘ì—… ë‚´ìš©:
  - Mock API (`mockAuthServer`) ëŒ€ì‹  ì‹¤ì œ `apiClient` ì‚¬ìš©
  - `login` í•¨ìˆ˜ ìˆ˜ì •:
    ```javascript
    const result = await apiClient.login(userId, password);
    // í† í° ì €ì¥
    await StorageService.saveTokens(result.access, result.refresh);
    // ì‚¬ìš©ì ì •ë³´ ì €ì¥
    await StorageService.saveCurrentUser(result.user);
    ```
  - `signup` í•¨ìˆ˜ ìˆ˜ì •:
    ```javascript
    const result = await apiClient.register(userId, password, phoneNumber);
    // íšŒì›ê°€ì…ë§Œ, í† í° ì €ì¥ ì•ˆ í•¨
    ```
  - ìë™ ë¡œê·¸ì¸ êµ¬í˜„:
    - ì•± ì‹œì‘ ì‹œ ì €ì¥ëœ í† í° í™•ì¸
    - í† í°ì´ ìˆìœ¼ë©´ `/api/auth/me/` í˜¸ì¶œí•˜ì—¬ ì‚¬ìš©ì ì •ë³´ í™•ì¸
    - ì„±ê³µí•˜ë©´ ìë™ ë¡œê·¸ì¸

**ì²´í¬ë¦¬ìŠ¤íŠ¸:**
- [ ] ë¡œê·¸ì¸ ì„±ê³µ ì‹œ í† í° ì €ì¥ í™•ì¸
- [ ] ì•± ì¬ì‹œì‘ ì‹œ ìë™ ë¡œê·¸ì¸ í™•ì¸
- [ ] ë¡œê·¸ì•„ì›ƒ ì‹œ í† í° ì‚­ì œ í™•ì¸

---

**3-2. í™”ë©´ ì—°ë™** â±ï¸ ì˜ˆìƒ: 30ë¶„
- íŒŒì¼: `Frontend/IdealMatchApp/src/screens/Auth/LoginScreen.js`
- íŒŒì¼: `Frontend/IdealMatchApp/src/screens/Auth/SignupScreen.js`
- ì‘ì—… ë‚´ìš©:
  - ì´ë¯¸ AuthContextë¥¼ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë¯€ë¡œ í° ìˆ˜ì • ë¶ˆí•„ìš”
  - ì—ëŸ¬ ë©”ì‹œì§€ ê°œì„  (ì„œë²„ ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ)
  - ë¡œë”© ìƒíƒœ ê°œì„ 

**ì²´í¬ë¦¬ìŠ¤íŠ¸:**
- [ ] íšŒì›ê°€ì… í”Œë¡œìš° í…ŒìŠ¤íŠ¸
- [ ] ë¡œê·¸ì¸ í”Œë¡œìš° í…ŒìŠ¤íŠ¸
- [ ] ì—ëŸ¬ ì²˜ë¦¬ í™•ì¸ (ì˜ëª»ëœ ë¹„ë°€ë²ˆí˜¸, ì¤‘ë³µ username ë“±)

---

### Phase 4: í†µí•© í…ŒìŠ¤íŠ¸ (í•¨ê»˜)

**4-1. ì „ì²´ í”Œë¡œìš° í…ŒìŠ¤íŠ¸** â±ï¸ ì˜ˆìƒ: 30ë¶„

**í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤:**
1. âœ… íšŒì›ê°€ì…
   - ìƒˆ ì‚¬ìš©ì ìƒì„±
   - ì¤‘ë³µ username ì²´í¬
   - ì¤‘ë³µ phone_number ì²´í¬

2. âœ… ë¡œê·¸ì¸
   - ì •ìƒ ë¡œê·¸ì¸
   - ì˜ëª»ëœ ë¹„ë°€ë²ˆí˜¸
   - ì¡´ì¬í•˜ì§€ ì•ŠëŠ” username

3. âœ… í† í° ê´€ë¦¬
   - í† í° ì €ì¥ í™•ì¸ (AsyncStorage)
   - í† í° ìë™ ì²¨ë¶€ í™•ì¸ (API ìš”ì²­ ì‹œ)
   - ì•± ì¬ì‹œì‘ ì‹œ ìë™ ë¡œê·¸ì¸

4. âœ… ë¡œê·¸ì•„ì›ƒ
   - í† í° ì‚­ì œ í™•ì¸
   - ë¡œê·¸ì•„ì›ƒ í›„ ë©”ì¸ í™”ë©´ ì ‘ê·¼ ë¶ˆê°€ í™•ì¸

**ì²´í¬ë¦¬ìŠ¤íŠ¸:**
- [ ] ë°±ì—”ë“œ ëª¨ë“  API ì •ìƒ ì‘ë™
- [ ] í”„ë¡ íŠ¸ì—”ë“œ ëª¨ë“  í™”ë©´ ì •ìƒ ì‘ë™
- [ ] í† í°ì´ ì˜¬ë°”ë¥´ê²Œ ì €ì¥/ì‚­ì œë¨
- [ ] ì—ëŸ¬ ë©”ì‹œì§€ê°€ ì‚¬ìš©ìì—ê²Œ ì˜¬ë°”ë¥´ê²Œ í‘œì‹œë¨

---

## ğŸ”„ í˜‘ì—… í”Œë¡œìš°

```
Phase 1 (ë³‘ë ¬ ì‘ì—…)
â”œâ”€ ë‹´ë‹¹ì A: Serializers êµ¬í˜„
â””â”€ ë‹´ë‹¹ì B: API í´ë¼ì´ì–¸íŠ¸ í•¨ìˆ˜ ì‘ì„±

Phase 2 (ë‹´ë‹¹ì A)
â”œâ”€ Views êµ¬í˜„
â””â”€ URL ë¼ìš°íŒ…

Phase 3 (ë‹´ë‹¹ì B) - Phase 2 ì™„ë£Œ í•„ìš”
â”œâ”€ AuthContext ì—°ë™
â””â”€ í™”ë©´ ì—°ë™

Phase 4 (í•¨ê»˜)
â””â”€ í†µí•© í…ŒìŠ¤íŠ¸
```

---

## ğŸ“ ì‘ì—… ì „ í™•ì¸ ì‚¬í•­

### ê³µí†µ
- [ ] Git ë¸Œëœì¹˜ ë¶„ê¸° (ê°ì ì‘ì—… ë¸Œëœì¹˜ ìƒì„±)
- [ ] ìµœì‹  ì½”ë“œ pull
- [ ] ê°œë°œ í™˜ê²½ ì„¤ì • í™•ì¸

### ë°±ì—”ë“œ (ë‹´ë‹¹ì A)
- [ ] Django ì„œë²„ ì‹¤í–‰ ê°€ëŠ¥í•œì§€ í™•ì¸
- [ ] PostgreSQL ì—°ê²° í™•ì¸
- [ ] Simple JWT ì„¤ì • í™•ì¸ (`settings.py`)
- [ ] Postman ë˜ëŠ” curl ì„¤ì¹˜ (API í…ŒìŠ¤íŠ¸ìš©)

### í”„ë¡ íŠ¸ì—”ë“œ (ë‹´ë‹¹ì B)
- [ ] React Native ì•± ì‹¤í–‰ ê°€ëŠ¥í•œì§€ í™•ì¸
- [ ] API_BASE_URL ì„¤ì • í™•ì¸ (`src/constants/config.js`)
- [ ] AsyncStorage ì •ìƒ ì‘ë™ í™•ì¸

---

## ğŸ› ë¬¸ì œ ë°œìƒ ì‹œ

### ë°±ì—”ë“œ ì—ëŸ¬
- CORS ì—ëŸ¬: `settings.py`ì˜ `CORS_ALLOWED_ORIGINS` í™•ì¸
- 401 ì—ëŸ¬: JWT í† í° í˜•ì‹ í™•ì¸
- 500 ì—ëŸ¬: Django ë¡œê·¸ í™•ì¸ (`python manage.py runserver`)

### í”„ë¡ íŠ¸ì—”ë“œ ì—ëŸ¬
- ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬: API_BASE_URL í™•ì¸, ì„œë²„ ì‹¤í–‰ í™•ì¸
- í† í° ì €ì¥ ì‹¤íŒ¨: AsyncStorage ê¶Œí•œ í™•ì¸
- ìë™ ë¡œê·¸ì¸ ì‹¤íŒ¨: í† í° í˜•ì‹ í™•ì¸

---

## ğŸ“ ì†Œí†µ í¬ì¸íŠ¸

### Phase 2 ì™„ë£Œ ì‹œ (ë‹´ë‹¹ì A â†’ ë‹´ë‹¹ì B)
- **ê³µìœ  ë‚´ìš©:**
  - API ì—”ë“œí¬ì¸íŠ¸ URL
  - ìš”ì²­/ì‘ë‹µ í˜•ì‹ (JSON ì˜ˆì‹œ)
  - ì—ëŸ¬ ì‘ë‹µ í˜•ì‹
  - í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•œ ì‚¬ìš©ì ê³„ì • (ì„ íƒì‚¬í•­)

### Phase 3 ì™„ë£Œ ì‹œ (ë‹´ë‹¹ì B â†’ ë‹´ë‹¹ì A)
- **ê³µìœ  ë‚´ìš©:**
  - í”„ë¡ íŠ¸ì—”ë“œ í…ŒìŠ¤íŠ¸ ê²°ê³¼
  - ë°œê²¬ëœ ë²„ê·¸ë‚˜ ê°œì„  ì‚¬í•­

---

## âœ… ì™„ë£Œ ê¸°ì¤€

### ë°±ì—”ë“œ ì™„ë£Œ
- [ ] ëª¨ë“  API ì—”ë“œí¬ì¸íŠ¸ ì‘ë™
- [ ] Postman/curlë¡œ ëª¨ë“  API í…ŒìŠ¤íŠ¸ í†µê³¼
- [ ] ì—ëŸ¬ ì²˜ë¦¬ ì •ìƒ ì‘ë™

### í”„ë¡ íŠ¸ì—”ë“œ ì™„ë£Œ
- [ ] íšŒì›ê°€ì… â†’ ë¡œê·¸ì¸ í”Œë¡œìš° ì •ìƒ ì‘ë™
- [ ] í† í° ì €ì¥/ì‚­ì œ ì •ìƒ ì‘ë™
- [ ] ìë™ ë¡œê·¸ì¸ ì •ìƒ ì‘ë™
- [ ] ì—ëŸ¬ ë©”ì‹œì§€ ì •ìƒ í‘œì‹œ

### í†µí•© ì™„ë£Œ
- [ ] ì „ì²´ í”Œë¡œìš° í…ŒìŠ¤íŠ¸ í†µê³¼
- [ ] ì½”ë“œ ë¦¬ë·° ì™„ë£Œ
- [ ] Merge ì¤€ë¹„ ì™„ë£Œ

---

## ğŸ“š ì°¸ê³  ìë£Œ

### ë°±ì—”ë“œ
- Django REST Framework: https://www.django-rest-framework.org/
- Simple JWT: https://django-rest-framework-simplejwt.readthedocs.io/
- í”„ë¡œì íŠ¸ íŒŒì¼:
  - `backend/apps/users/models.py` - ëª¨ë¸ êµ¬ì¡°
  - `backend/config/settings.py` - JWT ì„¤ì •

### í”„ë¡ íŠ¸ì—”ë“œ
- React Native AsyncStorage: https://react-native-async-storage.github.io/async-storage/
- í”„ë¡œì íŠ¸ íŒŒì¼:
  - `Frontend/IdealMatchApp/src/services/api/apiClient.js` - API í´ë¼ì´ì–¸íŠ¸
  - `Frontend/IdealMatchApp/src/context/AuthContext.js` - ì¸ì¦ ì»¨í…ìŠ¤íŠ¸
  - `Frontend/IdealMatchApp/src/constants/config.js` - ì„¤ì •

---

## ğŸ¯ ì˜ˆìƒ ì†Œìš” ì‹œê°„

- **Phase 1 (ë³‘ë ¬)**: 30ë¶„
- **Phase 2**: 1ì‹œê°„
- **Phase 3**: 1ì‹œê°„ 30ë¶„
- **Phase 4**: 30ë¶„
- **ì´ ì˜ˆìƒ ì‹œê°„**: 3-4ì‹œê°„

---

**ì¢‹ì€ í˜‘ì—… ë˜ì„¸ìš”! ğŸš€**
